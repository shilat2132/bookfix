{"version":3,"file":"static/js/731.6e5fd4cc.chunk.js","mappings":"0LAWO,SAASA,EAAmBC,GAAoB,IAAnB,QAACC,EAAO,OAAEC,GAAOF,EACjD,MAAMG,EARV,SAAsBC,GAAY,IAAX,QAACH,GAAQG,EAC5B,MACMC,EADM,IAAIC,IAAIL,EAAQM,KAAKC,aACZC,IAAI,YACzB,OAAIJ,GAA0BK,cAAbL,EACV,IAD+D,GAE1E,CAGuBM,CAAc,CAACV,YAClC,GAAiB,MAAdE,EAAmB,CAClB,MAAMS,EAAaV,EAAOU,WAC1B,MAAkB,UAAfA,GAAwC,YAAdA,GAClBC,EAAAA,EAAAA,IAAU,WAEVA,EAAAA,EAAAA,IAAS,IAADC,OAAKF,GAE5B,CAEA,OAAO,IACX,CAEAG,eAAeC,EAAYC,GAAoB,IAAnB,OAACf,EAAM,QAAED,GAAQgB,EACzC,MAAML,EAAaV,EAAOU,WAC1B,GAAkB,UAAfA,GAAwC,YAAdA,EACzB,OAAOC,EAAAA,EAAAA,IAAU,UAErB,IAAIK,EAAM,QAAAJ,OAAWF,GACrB,MAAML,EAAM,IAAID,IAAIL,EAAQM,KAAKC,aACjC,GAAGD,EAAIY,KAAM,EAAE,CACXD,GAAQ,IACR,IAAIE,EAAE,EACN,IAAK,MAAMC,KAAOd,EAAIe,OACfF,EAAE,IAAGF,GAAQ,KAChBA,GAAQ,GAAFJ,OAAMO,EAAG,KAAAP,OAAIP,EAAIE,IAAIY,IAC3BD,GAER,CACA,MAAMG,QAAiBC,MAAMN,GACvBO,QAAqBF,EAASG,OAEpC,IAAIH,EAASI,GACT,MAAMD,EAAAA,EAAAA,IAAK,CAACE,QAASH,EAAaG,SAAU,CAACC,OAAQN,EAASM,SAGlE,OAAOJ,EAAaK,IAExB,CAEO,SAASC,EAAWC,GAAoB,IAAnB,OAAC9B,EAAM,QAAED,GAAQ+B,EACzC,OAAOC,EAAAA,EAAAA,IAAM,CAACC,UAAWlB,EAAa,CAACd,SAAQD,aACnD,CAGAc,eAAeoB,EAAQC,GAAW,IAAV,OAAClC,GAAOkC,EAC5B,MAAMb,QAAiBC,MAAM,QAADV,OAASZ,EAAOU,WAAU,KAAAE,OAAIZ,EAAOmC,KAC3DZ,QAAqBF,EAASG,OACpC,IAAIH,EAASI,GACT,MAAMD,EAAAA,EAAAA,IAAK,CAACE,QAASH,EAAaG,SAAU,CAACC,OAAQN,EAASM,SAGlE,OAAOJ,CACX,CAEO,SAASa,EAAUC,GAAW,IAAV,OAACrC,GAAOqC,EAC/B,OAAON,EAAAA,EAAAA,IAAM,CAACO,SAAUL,EAAS,CAACjC,YACtC,C","sources":["utils/loaders.jsx"],"sourcesContent":["import { defer, json, redirect } from \"react-router-dom\";\r\n\r\n\r\n//PROTECT ROUTES\r\nfunction protectRoutes({request}){\r\n    const url = new URL(request.url).searchParams\r\n    const password = url.get(\"password\")\r\n    if(!password || (password !== process.env.REACT_APP_PASSWORD)) return 401\r\n    return 200\r\n}\r\n\r\nexport function protectRoutesLoader({request, params}){\r\n    const authStatus = protectRoutes({request})\r\n    if(authStatus !==200) {\r\n        const collection = params.collection\r\n        if(collection !== \"books\" && collection!== \"stories\"){\r\n            return redirect (\"/books\")\r\n        }else{\r\n            return redirect(`/${collection}`)\r\n        }\r\n    }\r\n    \r\n    return null\r\n}\r\n\r\nasync function loadAllItems({params, request}){\r\n    const collection = params.collection\r\n    if(collection !== \"books\" && collection!== \"stories\"){\r\n        return redirect (\"/books\")\r\n    }\r\n    let apiUrl = `/api/${collection}`\r\n    const url = new URL(request.url).searchParams\r\n    if(url.size >0){\r\n        apiUrl+=\"?\"\r\n        let i=0\r\n        for (const key of url.keys()) {\r\n            if(i>0) apiUrl+=\"&\"\r\n            apiUrl+= `${key}=${url.get(key)}`\r\n            i++\r\n          }\r\n    }\r\n    const response = await fetch(apiUrl)\r\n    const responseData = await response.json()\r\n\r\n    if(!response.ok){\r\n        throw json({message: responseData.message}, {status: response.status})\r\n    }\r\n\r\n    return responseData.docs\r\n\r\n}\r\n\r\nexport function itemsLoader({params, request}){\r\n    return defer({itemsData: loadAllItems({params, request})})\r\n}\r\n\r\n\r\nasync function loadItem({params}){\r\n    const response = await fetch(`/api/${params.collection}/${params.id}`)\r\n    const responseData = await response.json()\r\n    if(!response.ok){\r\n        throw json({message: responseData.message}, {status: response.status})\r\n    }\r\n\r\n    return responseData\r\n}\r\n\r\nexport function itemLoader({params}){\r\n    return defer({itemData: loadItem({params})})\r\n}\r\n"],"names":["protectRoutesLoader","_ref2","request","params","authStatus","_ref","password","URL","url","searchParams","get","process","protectRoutes","collection","redirect","concat","async","loadAllItems","_ref3","apiUrl","size","i","key","keys","response","fetch","responseData","json","ok","message","status","docs","itemsLoader","_ref4","defer","itemsData","loadItem","_ref5","id","itemLoader","_ref6","itemData"],"sourceRoot":""}