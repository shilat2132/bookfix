{"version":3,"file":"static/js/965.6eb0c456.chunk.js","mappings":"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","sources":["pages/comments/AllComments.jsx","webpack://client/./src/styles/comments.module.css?b215","pages/comments/CommentsItems.jsx","webpack://client/./src/styles/form.module.css?d1fe"],"sourcesContent":["import { useState } from \"react\"\r\nimport { Form, useActionData } from \"react-router-dom\"\r\nimport { Comments } from \"./CommentsItems\"\r\n\r\n/**at first shows a form of the admin password.\r\n * after the form is submitted, if authorized - shows the comments component. if not - shows an error message */\r\nconst AllComments = ()=>{\r\n    const action = useActionData()\r\n    const [showForm, setShowForm] = useState(true)\r\n\r\n    if(showForm && action && action.comments){\r\n        setShowForm(false)\r\n    }\r\n\r\n        \r\n        return (<>\r\n    {showForm && <Form method=\"POST\">\r\n        <input placeholder=\"סיסמת מנהל\" type=\"text\" required name=\"secret\"/>\r\n        <button>שלח</button>\r\n        \r\n        {action && action.error && <p className=\"formErrorMessage\">{action.error} </p>}\r\n        </Form>}\r\n\r\n    {!showForm && <Comments from=\"admin\" secret={action.secret} comments={action.comments}/> }\r\n            </>\r\n        )\r\n}\r\n\r\n/**\r\n * action for delete a comment or get all comments. both require admin password, aka secret\r\n */\r\nexport const commentsActions = async ({request, params})=>{\r\n    const formData = await request.formData()\r\n    const toDelete = request.method === \"DELETE\"\r\n    const secret = formData.get(\"secret\")\r\n    let url = \"/api/comments\"\r\n    if(toDelete){\r\n        url+= `/${formData.get(\"id\")}`\r\n    }\r\n    url+=`/${secret}`\r\n\r\n\r\n    const response = await fetch(url, {method: toDelete ? \"DELETE\" : \"GET\"})\r\n\r\n    if(!toDelete){\r\n        const responseData = await response.json()\r\n\r\n        if(!response.ok){\r\n            return {error: responseData.message}\r\n        }\r\n\r\n        return {comments: responseData.docs, secret: secret}\r\n    }else{\r\n        if(!response.ok){\r\n            const responseData = await response.json()\r\n            return {error: responseData.message}\r\n        }\r\n    }\r\n    return {success: \"התגובה נמחקה\"}\r\n}\r\n\r\nexport default AllComments","// extracted by mini-css-extract-plugin\nexport default {\"title\":\"comments_title__D7jqg\",\"subtitle\":\"comments_subtitle__vA2B7\",\"cardBody\":\"comments_cardBody__HQx6d\",\"row\":\"comments_row__32Rwn\",\"cardText\":\"comments_cardText__Z9SkA\",\"commentCard\":\"comments_commentCard__QlmRN\",\"commentsSection\":\"comments_commentsSection__rM01p\",\"titles\":\"comments_titles__JFAd6\"};","import { useFetcher } from \"react-router-dom\"\r\nimport formStyles from '../../styles/form.module.css'\r\nimport Form from 'react-bootstrap/Form';\r\nimport Card from 'react-bootstrap/Card';\r\nimport commentsStyles from '../../styles/comments.module.css'\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport { useState } from 'react';\r\n\r\n/**shows a list of comments, either for the admin with a delete button or for the user, as part of the comments section */\r\nexport const Comments = ({comments, from, secret})=>{\r\n    const fetcher = useFetcher()\r\n    if(!comments|| comments.length ===0){\r\n        return <p style={{marginTop: \"unset\"}} className=\"generalMsg\">עדיין לא נוספו תגובות</p>\r\n    }\r\n    const fromAdmin = from === \"admin\"\r\n\r\n    /**available only for admin, to trigger the delete comment action without navigating to another page */\r\n    function deleteComment(id){\r\n        fetcher.submit({id, secret}, { method: \"DELETE\"})\r\n    }\r\n\r\n    return(\r\n<div className={`${commentsStyles.row} text-center`}>\r\n    {/* those are the messages that would be showed after trying to delete a comment - either an error or a success */}\r\n    {fetcher.data && fetcher.data.error && <p className=\"errorMessage\">{fetcher.data.error} </p>}\r\n    {fetcher.data && fetcher.data.success && <p className=\"generalMsg\">{fetcher.data.success} </p>}\r\n    \r\n    <h4 style={{textAlign: \"right\"}}>תגובות</h4>\r\n    <div className={`row `}>\r\n      {comments.map(comment=>(\r\n            <Card key={comment._id} className={`col-xl-4 col-lg-5 col-12 col-sm-5 ${commentsStyles.commentCard}`} >\r\n                <Card.Body className={commentsStyles.cardBody}>\r\n                    <div className={commentsStyles.titles}>\r\n                        <Card.Title className={commentsStyles.title}>{comment.name}</Card.Title>\r\n                        {fromAdmin && <Card.Subtitle className={`${commentsStyles.subtitle} mb-2 text-muted`}>\r\n                            {comment.story.title}</Card.Subtitle>}\r\n                    </div>\r\n                    <Card.Text className={commentsStyles.cardText}>{comment.text}\r\n                        {fromAdmin && comment.email &&<> <br/> <span>{comment.email}</span>  </>}\r\n                    </Card.Text>\r\n                    {fromAdmin && <button onClick={e=> deleteComment(comment._id)} className=\"button\">מחיקת תגובה</button> }\r\n                </Card.Body>\r\n          </Card>\r\n      ))}\r\n      \r\n    </div>\r\n</div>\r\n    )\r\n}\r\n\r\n/**a form for adding a comment */\r\nexport function CommentForm(){\r\n    const fetcher = useFetcher()\r\n\r\n    /**submit handler for adding a new comment.\r\n     * triggers the action of adding a comment and sends the comment's data\r\n     */\r\n    function handleSubmit(event){\r\n        event.preventDefault()\r\n        const formData = new FormData(event.target)\r\n        const data ={}\r\n        formData.forEach((value, key)=>{\r\n            data[key] = value\r\n        })\r\n        fetcher.submit(data, {method: \"POST\"})\r\n    }\r\n        return(\r\n            <form onSubmit={e=> handleSubmit(e)}>\r\n                <Form.Group className={`mb-3 ${formStyles.formGroup}`}>\r\n                    <Form.Label>שם</Form.Label>\r\n                    <Form.Control name=\"name\" type=\"text\" required />\r\n                </Form.Group>\r\n\r\n                <Form.Group className={`mb-3 ${formStyles.formGroup}`}>\r\n                    <Form.Label>אימייל</Form.Label>\r\n                    <Form.Control name=\"email\" type=\"text\" />\r\n                </Form.Group>\r\n\r\n                <Form.Group className={`mb-3 ${formStyles.formGroup}`}>\r\n                    <Form.Label>תגובה</Form.Label>\r\n                    <Form.Control name=\"text\" as=\"textarea\" required />\r\n                </Form.Group>\r\n                {fetcher.data && fetcher.data.success && <p className=\"successMsg\">{fetcher.data.success}</p>}\r\n                {fetcher.data && fetcher.data.error && <p className=\"formErrorMessage\">{fetcher.data.error}</p>}\r\n                <button className={formStyles.button}>הוספה</button>\r\n            </form>\r\n        )\r\n}\r\n\r\n/**the comment section component.\r\n * has a model for adding a comment\r\n */\r\nexport function CommentsSection({comments}){\r\n    const [show, setShow] = useState(false);\r\n\r\n    const handleClose = () => setShow(false);\r\n    const handleShow = () => setShow(true);\r\n\r\n    return(\r\n        <div className={commentsStyles.commentsSection}>\r\n            <button className=\"button\" onClick={handleShow}>כתבו תגובה</button>\r\n            <Modal show={show} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                <Modal.Title>הוספת תגובה</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body><CommentForm/> </Modal.Body>\r\n            </Modal>\r\n            <Comments comments={comments} from=\"user\"/>\r\n        </div>\r\n        )\r\n        \r\n}","// extracted by mini-css-extract-plugin\nexport default {\"formGroup\":\"form_formGroup__kmBMA\",\"button\":\"form_button__BOhvg\",\"deleteBtn\":\"form_deleteBtn__lwSyp\",\"form\":\"form_form__IX2UE\"};"],"names":["commentsActions","async","request","params","_ref","formData","toDelete","method","secret","get","url","response","fetch","responseData","json","ok","comments","docs","error","message","success","AllComments","action","useActionData","showForm","setShowForm","useState","_jsxs","_Fragment","children","Form","_jsx","placeholder","type","required","name","className","Comments","from","fetcher","useFetcher","length","style","marginTop","fromAdmin","commentsStyles","row","data","textAlign","map","comment","Card","commentCard","Body","cardBody","titles","Title","title","Subtitle","subtitle","story","Text","cardText","text","email","onClick","e","deleteComment","id","_id","submit","CommentForm","onSubmit","event","preventDefault","FormData","target","forEach","value","key","handleSubmit","Group","formStyles","formGroup","Label","Control","as","button","CommentsSection","_ref2","show","setShow","commentsSection","handleShow","Modal","onHide","handleClose","Header","closeButton"],"sourceRoot":""}